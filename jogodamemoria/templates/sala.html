{% extends 'base_site.html' %}
{% block title %}
    <title>Jogo da Memória - Sala</title>
{% endblock %}

{% block content %}
    <div class="row linha-titulo">
        <div class="col-6 titulo-sala">
            <h1>Nome da Sala</h1> <!-- TODO remover hardcode -->
            <img src="../static/img/settings.png" class="img-settings" onclick="abreMenuConfiguracoes()">
        </div>
        <div class="col-6 menu-sair">
            <div class="text-center">
                <img src="../static/img/sair.png" class="img-sair" onclick="abreModalSairSala()">
                <p>Sair</p>
            </div>
        </div>
    </div>
    <div class="container corpo-container">
        <div class="row">
            <div class="card col-sm text-center card-grande">
                <div class="card-body  card-usuario">
                    <h5 class="card-title">Nome do usuario</h5> <!-- TODO remover hardcode -->
                    <img src="../static/img/nopicture.png" class="img-usuario">
                    <button class="btn-confirmar" onclick="confirmarPartida(this)">Confirmar</button>
                </div>
            </div>
            <div class="col-sm text-center">
                <h5 class="card-title">Dificuldade da partida</h5> <!-- TODO remover hardcode -->
                <div class="vs-img">
                    <img src="../static/img/vs.png" class="img-usuario">
                </div>
            </div>
            <div class="card col-sm text-center card-grande">
                <div class="card-body  card-usuario">
                    <h5 class="card-title">Nome do usuario</h5> <!-- TODO remover hardcode -->
                    <img src="../static/img/nopicture.png" class="img-usuario">
                    <button class="btn-confirmar" onclick="confirmarPartida(this)">Confirmar</button>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm text-center estado-jogadores">
                AGUARDANDO CONFIRMAÇÃO DOS JOGADORES
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal" id="modalSairSala" aria-hidden="true">
        <div class="modal-dialog modal-sm" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="newAccTitle">Tem certeza que deseja sair da sala?</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Fechar">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                    <button type="button" id="createacc" class="btn btn-primary" onclick="history.back()">Sair</button> <!-- TODO redirecionar para o lobby -->
                </div>
            </div>
        </div>
    </div>
{% endblock %}
		
{% block extrajs %}
    <script>
        const abreMenuConfiguracoes = () => {
            alert('Implementar o menu!!!');
        };

        const abreModalSairSala = () => {
            $('#modalSairSala').modal('toggle');
        };

        const confirmarPartida = (element) => {
            $(element).replaceWith('<img class="img-check" src="../static/img/check.png">');
            $('.img-check').css({'margin-top': '40px'}).after('<p class="cancelar" onclick="cancelarConfirmacao(this)">Cancelar</p>');
            let i = 3;
            setInterval(() => {
                $('.estado-jogadores').text('Iniciando em ' + i + '...');
                i--;
                if(i === 0) {
                    location.href = '/partida/'
                }
            }, 1000)
        };

        const cancelarConfirmacao = (element) => {
            const imgCheck = $(element).prev();
            $(element).remove();
            imgCheck.replaceWith('<button class="btn-confirmar" onclick="confirmarPartida(this)">Confirmar</button>');
        };
    </script>
{% endblock %}
